<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Milk Supply Memo</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 10px; background: #f5f5f5; }
    .shop { border: 2px solid #ccc; border-radius: 10px; padding: 15px; margin: 10px 0; background: #fff; }
    .shop h3 { margin-top: 0; color: #333; text-align: center; }
    .milk-row { display: flex; justify-content: space-between; margin: 5px 0; }
    label { flex: 1; }
    input[type='number'] { width: 80px; }
    .total-display { margin-top: 10px; font-weight: bold; color: green; }
    button { margin-top: 10px; padding: 5px 15px; }
    #grandTotal { font-size: 1.3em; margin-top: 20px; text-align: center; color: darkblue; }
    .shop-image-container { width: 100%; max-width: 200px; height: 150px; overflow: hidden; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; border: 1px solid #ccc; border-radius: 8px; background-color: #fdfdfd; }
    .shop-image-container img { width: 100%; height: 100%; object-fit: contain; }
  </style>
</head>
<body>

  <h2>Milk Supply Memo</h2>

  <div id="shops"></div>

  <div style="text-align: center;">
    <button onclick="calculateGrandTotal()">Calculate Grand Total</button>
    <div id="grandTotal"></div>
  </div>

  <script>
    const milkTypes = [
      { name: "Special (27₹)", price: 27 },
      { name: "Family (27₹)", price: 27 },
      { name: "Ordinary (24₹)", price: 24 },
      { name: "Special 1L (52₹)", price: 52 },
      { name: "Ordinary 1L (46₹)", price: 46 },
      { name: "Samruddhi (28₹)", price: 28 },
      { name: "1/2 Curd (28₹)", price: 28 }
    ];

    const shopNames = [
      "Chowdeshwari", "Raghu", "Milk point", "Muslim angadi", "Vignesha", "Krishnappa",
      "Reddy andra", "Raajashekhar", "Lakshmama", "Navya prakash pakkana angadi aludu",
      "Pk home", "Prakash", "Vignesha pakkana", "Muslamma", "Muslim bakery", "Bhaskar",
      "Naganna bakery", "Aunty", "Balaji", "Uma", "Canara Bank", "Cafe", "Beeda shop", "Manjunatha bakery"
    ];

    function createShopBlock(name, index) {
      const imageName = name.replaceAll(" ", "%20") + ".png"; // changed to .png
      let html = `<div class='shop' id='shop${index}'>`;
      html += `<div class='shop-image-container'><img src='./images/${imageName}' alt='${name}' onerror="this.onerror=null;this.src='fallback.png';"></div>`;
      html += `<h3>${name}</h3>`;
      milkTypes.forEach((milk, i) => {
        html += `<div class='milk-row'><label>${milk.name}</label><input type='number' min='0' id='q${index}_${i}'></div>`;
      });
      html += `<div class='milk-row'><label>Heritage Milk (₹)</label><input type='number' min='0' id='heritage${index}'></div>`;
      html += `<button onclick='calculateShopTotal(${index})'>Calculate Total</button>`;
      html += `<div class='total-display' id='total${index}'></div>`;
      html += `</div>`;
      return html;
    }

    function loadShops() {
      const container = document.getElementById("shops");
      shopNames.forEach((name, index) => {
        container.innerHTML += createShopBlock(name, index);
      });
      document.querySelectorAll('input[type="number"]').forEach(input => {
        input.addEventListener('input', () => {
          if (input.value < 0) input.value = 0;
        });
      });
    }

    function calculateShopTotal(index) {
      let total = 0;
      milkTypes.forEach((milk, i) => {
        const qty = parseInt(document.getElementById(`q${index}_${i}`).value) || 0;
        total += qty * milk.price;
      });
      const heritage = parseInt(document.getElementById(`heritage${index}`).value) || 0;
      total += heritage;
      document.getElementById(`total${index}`).innerText = `Shop Total: ₹${total}`;
      return total;
    }

    function calculateGrandTotal() {
      let grandTotal = 0;
      shopNames.forEach((_, index) => {
        grandTotal += calculateShopTotal(index);
      });
      document.getElementById("grandTotal").innerText = `Grand Total: ₹${grandTotal}`;
    }

    loadShops();
  </script>
</body>
</html>
